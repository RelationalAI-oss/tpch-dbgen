`/bin/bash -c "alias ll='ls -la'

vecho() {
    if [[ \"false\" == \"true\" ]]; then
        echo \"\$@\"
    fi
}
vecho_red() {
    (vecho \"\$@\" >&2)
}

# Save bash history (and optionally echo it out as it happens)
save_history() {
    vecho_red \" ---> \$BASH_COMMAND\"
    history -s \"\$BASH_COMMAND\"
    history -a
}

# Save our environment into \`/meta/.env\`, eliminating read-only variables
# so that this file can be sourced upon entering a debug shell.
save_env() {
    set +x
    set > /meta/.env
    # Ignore read-only variables
    for l in BASHOPTS BASH_VERSINFO UID EUID PPID SHELLOPTS; do
        grep -v \"^\$l=\" /meta/.env > /meta/.env2
        mv /meta/.env2 /meta/.env
    done
    echo \"cd \$(pwd)\" >> /meta/.env
}

# We do a little sleight-of-hand here; we want to build inside of a tmpfs
# because \`srcdir\` might be mapped in through a networked filesystem, which
# totally wrecks our I/O performance.  So what we do instead is bind-mount
# \`srcdir\` to another location so that we can always get at it, copy its
# contents to a new tmpfs we mount at the location of \`srcdir\`, then when
# we exit on an error, we copy everything back over again
tmpify_srcdir() {
    vecho \"Copying srcdir to tmpfs...\"
    mkdir -p \$WORKSPACE/.true_srcdir
    mount --bind \$WORKSPACE/srcdir \$WORKSPACE/.true_srcdir
    mount -t tmpfs tmpfs \$WORKSPACE/srcdir
    rsync -rlptD \$WORKSPACE/.true_srcdir/ \$WORKSPACE/srcdir

    # We may have changed what pwd() means out from underneath ourselves
    cd \$(pwd)
}

# Copy our tmpfs version of \`srcdir\` back onto disk.
save_srcdir() {
    vecho_red \"Saving srcdir due to previous error...\"
    rsync -rlptD \$WORKSPACE/srcdir/ \$WORKSPACE/.true_srcdir --delete
}

# If /meta is mounted, then we want to save history and environment
if [[ -d /meta ]]; then
    trap save_history DEBUG
    trap \"save_env\" EXIT
    trap \"save_env; save_srcdir\" INT TERM ERR
fi

# Stop if we hit any errors.
set -e

# Swap out srcdir from underneath our feet
tmpify_srcdir

cd \$WORKSPACE/srcdir
pwd
ls -l 
cd dbgen-delve
make CC=\"\$CC\"
mkdir \$prefix/tpch-dbgen
cp -R * \$prefix/tpch-dbgen/

cd ../dbgen
make CC=\"\$CC\"
cp dbgen qgen \$prefix/tpch-dbgen/

"`
/workspace/srcdir
total 2984
-rw-rw-r--    1 root     root         17809 May 14 09:44 EULA.txt
drwxrwxr-x    3 root     root            60 May 14 10:05 build
-rw-rw-r--    1 root     root          1138 May 14 09:54 build_tarballs.jl
drwxrwxr-x    8 root     root           920 May 14 10:04 dbgen
drwxrwxr-x    8 root     root           960 May 14 09:56 dbgen-delve
drwxrwxr-x    2 root     root            60 May 14 09:44 dev-tools
drwxrwxr-x    2 root     root            60 May 14 10:05 products
drwxrwxr-x   10 root     root           200 May 14 09:44 ref_data
-rw-rw-r--    1 root     root        602880 May 14 09:44 tpc-ds_v2.17.3.docx
-rw-rw-r--    1 root     root       2422117 May 14 09:44 tpc-ds_v2.17.3.pdf
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o build.o build.c
build.c:420:20: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
        PR_DATE(t->alpha, y, m,
        ~~~~~~~~~~~~~~~~~~^~~~~
./dss.h:488:34: note: expanded from macro 'PR_DATE'
sprintf(tgt, "19%02d-%02d-%02d", yr, mn, dy)
                ~~~~             ^~
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro '\
sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
build.c:420:23: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
        PR_DATE(t->alpha, y, m,
        ~~~~~~~~~~~~~~~~~~~~~^~
./dss.h:488:38: note: expanded from macro 'PR_DATE'
sprintf(tgt, "19%02d-%02d-%02d", yr, mn, dy)
                     ~~~~            ^~
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro '\
sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
build.c:421:3: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                d - months[m - 1].dcnt - ((LEAP(y) && m > 2) ? 1 : 0));
~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
./dss.h:488:42: note: expanded from macro 'PR_DATE'
sprintf(tgt, "19%02d-%02d-%02d", yr, mn, dy)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro '\
sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
3 warnings generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o driver.o driver.c
driver.c:325:4: warning: add explicit braces to avoid dangling else [-Wdangling-else]
                        else
                        ^
driver.c:429:7: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                        s, children, tdefs[tbl].comment);
                           ^~~~~~~~
driver.c:755:5: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                                upd_num + 1, tdefs[ORDER_LINE].comment);
                                ^~~~~~~~~~~
3 warnings generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o bm_utils.o bm_utils.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o rnd.o rnd.c
rnd.c:132:9: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                                        i, Seed[i].usage); 
                                           ^~~~~~~~~~~~~
1 warning generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o print.o print.c
print.c:138:32: warning: format specifies type 'long' but the argument has type 'int' [-Wformat]
                fprintf(target, "%ld.%02ld", dollars, cents);
                                 ~~~         ^~~~~~~
                                 %d
print.c:138:41: warning: format specifies type 'long' but the argument has type 'int' [-Wformat]
                fprintf(target, "%ld.%02ld", dollars, cents);
                                     ~~~~~            ^~~~~
                                     %02d
2 warnings generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o load_stub.o load_stub.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o bcd2.o bcd2.c
bcd2.c:166:17: warning: add explicit braces to avoid dangling else [-Wdangling-else]
                SET_DIGIT(res, udigit + ldigit, bcd_low, bcd_high);
                ^
bcd2.c:51:5: note: expanded from macro 'SET_DIGIT'
    else \
    ^
1 warning generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o speed_seed.o speed_seed.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o text.o text.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o permute.o permute.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o rng64.o rng64.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING  -O -o dbgen-delve build.o driver.o bm_utils.o rnd.o print.o load_stub.o bcd2.o speed_seed.o text.o permute.o rng64.o -lm
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o qgen.o qgen.c
qgen.c:194:29: warning: field precision should have type 'int', but argument has type 'long' [-Wformat]
                  printf("%.*s", cptr - mark + 2, mark);
                          ~~^~   ~~~~~~~~~~~~~~~
qgen.c:486:38: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                sprintf(qname, "%d", SEQUENCE(snum, atoi(av[i])));
                ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~
                                %ld
./tpcd.h:133:33: note: expanded from macro 'SEQUENCE'
#define SEQUENCE(stream, query) permutation[stream % MAX_PERMUTE][query - 1]
                                ^
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro 'sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
qgen.c:493:38: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                sprintf(qname, "%d", SEQUENCE(snum, i));
                ~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~
                                %ld
./tpcd.h:133:33: note: expanded from macro 'SEQUENCE'
#define SEQUENCE(stream, query) permutation[stream % MAX_PERMUTE][query - 1]
                                ^
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro 'sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
3 warnings generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING    -c -o varsub.o varsub.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64 -DEOL_HANDLING  -O -o qgen-delve build.o bm_utils.o qgen.o rnd.o varsub.o text.o bcd2.o permute.o speed_seed.o rng64.o -lm
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64    -c -o build.o build.c
build.c:420:20: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
        PR_DATE(t->alpha, y, m,
        ~~~~~~~~~~~~~~~~~~^~~~~
./dss.h:488:34: note: expanded from macro 'PR_DATE'
sprintf(tgt, "19%02d-%02d-%02d", yr, mn, dy)
                ~~~~             ^~
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro '\
sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
build.c:420:23: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
        PR_DATE(t->alpha, y, m,
        ~~~~~~~~~~~~~~~~~~~~~^~
./dss.h:488:38: note: expanded from macro 'PR_DATE'
sprintf(tgt, "19%02d-%02d-%02d", yr, mn, dy)
                     ~~~~            ^~
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro '\
sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
build.c:421:3: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                d - months[m - 1].dcnt - ((LEAP(y) && m > 2) ? 1 : 0));
~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
./dss.h:488:42: note: expanded from macro 'PR_DATE'
sprintf(tgt, "19%02d-%02d-%02d", yr, mn, dy)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/secure/_stdio.h:47:56: note: expanded from macro '\
sprintf'
  __builtin___sprintf_chk (str, 0, __darwin_obsz(str), __VA_ARGS__)
                                                       ^~~~~~~~~~~
3 warnings generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64    -c -o driver.o driver.c
driver.c:325:4: warning: add explicit braces to avoid dangling else [-Wdangling-else]
                        else
                        ^
driver.c:429:7: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                        s, children, tdefs[tbl].comment);
                           ^~~~~~~~
driver.c:755:5: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                                upd_num + 1, tdefs[ORDER_LINE].comment);
                                ^~~~~~~~~~~
3 warnings generated.
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64    -c -o bm_utils.o bm_utils.c
/opt/x86_64-linux-gnu/tools/clang -target x86_64-apple-darwin14 --sysroot /opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root -g -DDBNAME=\"dss\" -DMAC -DSQLSERVER -DTPCH -DRNG_TEST -D_FILE_OFFSET_BITS=64    -c -o rnd.o rnd.c
rnd.c:132:9: warning: format specifies type 'int' but the argument has type 'long' [-Wformat]
                                        i, Seed[i].usage); 
                                           ^~~~~~~~~~~~~
rnd.c:206:5: error: unknown type name 'int32_t'; did you mean '__int32_t'?
    int32_t     nLow32 = (int32_t)nLow,
    ^~~~~~~
    __int32_t
/opt/x86_64-apple-darwin14/x86_64-apple-darwin14/sys-root/usr/include/i386/_types.h:44:15: note: '__int32_t' declared here
typedef int                     __int32_t;
                                ^
rnd.c:206:23: error: use of undeclared identifier 'int32_t'
    int32_t     nLow32 = (int32_t)nLow,
                          ^
rnd.c:207:14: error: use of undeclared identifier 'int32_t'
                nHigh32 = (int32_t)nHigh;
                           ^
1 warning and 3 errors generated.
make: *** [<builtin>: rnd.o] Error 1
